<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>A Simple Page with CKEditor</title>
    {{ codemirror.include_codemirror() }}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cloud.tinymce.com/stable/tinymce.min.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
	<script>
    $(document).ready(function() {
        $('form').submit(function (e) {
            var url = "/dashboard/excercise/post/";
            $.ajax({
                type: "POST",
                url: url,
                data: $('form').serialize(),
                success: function (data) {
                   // console.log(data)
                        //console.log(JSON.stringify(data));
                        //console.log(JSON.parse(JSON.stringify(data)));
                        var obj = JSON.parse(JSON.stringify(data));
                        console.log(obj.data.message);
                        console.log(eval(obj.data));
                        $("#results").html(obj.data.message);
                        //$("#result").append(j);
			CKEDITOR.instances.editor1.insertHtml(obj.data.message);
                }
            });
            e.preventDefault();
        });
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", "{{ form.csrf_token._value() }}")
                }
            }
        })
    });
	</script>

   <script src="/static/js/ckeditor/ckeditor.js"></script>
    </head>
    <body>
        <div class="middle">
	<form method='POST' action="">
                {{ form.csrf_token }}
		<h5>Edit Code</h5>
		{{ form.source_code }}
                <div>
			<input type="submit" class="button" value="Run Code >>" />
			<div class="message">
		{% with messages = get_flashed_messages() %}
        {% if messages %}
                {% for message in messages %}
                <p>{{ message }}</p>
                {% endfor %}
        {% endif %}
        {% endwith %}
	</div>
		</div>
	    
	    
	    
	<form>
            <textarea name="editor1" id="editor1" rows="5" cols="20">
            </textarea>
            <script>
                // Replace the <textarea id="editor1"> with a CKEditor
                // instance, using default configuration.
                    
		    CKEDITOR.replace( 'editor1' );
            </script>
        </form>
    </body>
</html>
